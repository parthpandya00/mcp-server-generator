# Generated by MCP Server Generator
FROM python:3.11-slim

WORKDIR /usr/src/app

# --- Server Configuration ---
# Options: web, stdio
ENV TRANSPORT_MODE="web"
ENV HOST="0.0.0.0"
ENV PORT="8000"

# --- Credentials & Config ---
{% if auth_source_config and auth_source_config.vault_address %}
ENV VAULT_ADDR="{{ auth_source_config.vault_address }}"
{% endif %}
{% for key, value in direct_secrets.items() %}
ENV {{ key.upper() }}="{{ value }}"
{% endfor %}
ENV MCP_CONFIG='{{ mcp_config_json }}'

# --- Application Setup ---
# CORRECTED: Copy the entire package directory
COPY ./src/generic_mcp_server/ ./generic_mcp_server/
RUN pip install --no-cache-dir -r ./generic_mcp_server/requirements.txt

EXPOSE ${PORT}

# CORRECTED: Run the app as a module to fix relative imports
CMD ["python", "-u", "-m", "generic_mcp_server.run"]
